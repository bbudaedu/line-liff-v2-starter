# 實作計畫

- [x] 1. 建立專案基礎架構和核心介面



  - 建立 Next.js 專案結構，包含頁面、元件、樣式和 API 路由目錄
  - 設定 LIFF SDK 整合和基礎配置檔案
  - 建立核心資料模型的 TypeScript 介面定義
  - 設定環境變數和配置管理系統
  - _需求: 6.1, 6.2_

- [x] 2. 實作 LIFF 初始化和使用者驗證系統





  - 建立 LIFF SDK 初始化邏輯，包含錯誤處理和重試機制
  - 實作使用者登入狀態檢查和自動登入流程
  - 建立使用者資料獲取功能（姓名、頭像、LINE ID）
  - 實作權限檢查和請求功能（profile, openid 權限）
  - 撰寫 LIFF 整合的單元測試
  - _需求: 6.1, 6.2, 6.3, 6.4_

- [x] 3. 建立響應式 UI 基礎元件庫





  - 實作基礎 UI 元件（按鈕、輸入框、卡片、載入動畫）
  - 建立響應式佈局元件和網格系統
  - 實作大字體設計系統和無障礙功能
  - 建立佛教風格的色彩系統和主題配置
  - 實作載入狀態和錯誤訊息顯示元件
  - 撰寫 UI 元件的視覺回歸測試
  - _需求: 7.1, 7.2, 7.3, 7.4, 7.5_

- [x] 4. 實作使用者身份選擇功能





  - 建立身份選擇頁面（法師/志工選項）
  - 實作身份資料的本地儲存和狀態管理
  - 建立身份驗證和切換功能
  - 實作首次使用者引導流程
  - 撰寫身份管理功能的整合測試
  - _需求: 1.1, 1.2, 1.3, 1.4_

- [x] 5. 建立後端 API 基礎架構





  - 設定 Express.js 伺服器和中介軟體配置
  - 建立資料庫連接和模型定義（使用者、活動、報名、交通）
  - 實作統一的錯誤處理和日誌記錄系統
  - 建立 API 路由結構和版本控制
  - 實作請求驗證和安全性中介軟體
  - 撰寫 API 基礎架構的單元測試
  - _需求: 5.1, 5.2, 5.3_

- [x] 6. 實作 LINE 使用者驗證 API




  - 建立 LINE 存取權杖驗證端點
  - 實作使用者資料獲取和儲存邏輯
  - 建立使用者身份設定和更新 API
  - 實作好友狀態檢查功能
  - 撰寫使用者驗證 API 的整合測試
  - _需求: 6.1, 6.2, 6.4_

- [x] 7. 實作 Pretix API 整合服務





  - 建立 Pretix API 客戶端和認證配置
  - 實作活動資料獲取功能（事件、項目、配額）
  - 建立訂單建立和狀態查詢功能
  - 實作錯誤處理和重試機制
  - 建立 Pretix 資料同步和快取機制
  - 撰寫 Pretix 整合的模擬測試
  - _需求: 5.1, 5.2, 5.3, 5.4_

- [x] 8. 建立活動管理 API 端點


  - 實作活動列表獲取 API（包含報名狀態和人數）
  - 建立特定活動詳情查詢端點
  - 實作活動報名狀態即時更新功能
  - 建立交通車資訊管理 API
  - 撰寫活動管理 API 的功能測試
  - _需求: 2.1, 2.2, 2.4_

- [x] 9. 實作前端活動列表和詳情頁面





  - 建立活動列表頁面（/events），顯示可報名活動卡片
  - 實作活動詳情頁面（/events/[id]），包含完整活動資訊
  - 建立報名按鈕和狀態顯示功能
  - 實作活動搜尋和篩選功能
  - 建立活動額滿和截止狀態的視覺提示
  - 整合現有的 API 端點和 UI 元件
  - 撰寫活動頁面的 E2E 測試
  - _需求: 2.1, 2.2, 2.3, 2.4_

- [x] 10. 建立個人資料填寫表單系統





  - 實作動態表單元件，根據身份類型顯示不同欄位
  - 建立法師專用表單（法名、俗名、身分證字號、出生年月日、電話、道場名稱、特殊需求）
  - 建立志工專用表單（姓名、身分證字號、出生年月日、電話、特殊需求）
  - 實作即時表單驗證和錯誤提示
  - 建立表單資料自動儲存和恢復功能
  - 撰寫表單驗證和提交的單元測試
  - _需求: 3.1, 3.2, 3.3, 3.4, 3.5_

- [x] 11. 實作交通車登記系統








  - 建立交通車地點選擇介面
  - 實作地點詳情顯示（時間、地址、座位狀況）
  - 建立座位數量即時更新功能
  - 實作地點額滿狀態處理和替代選項
  - 建立交通車登記確認和取消功能
  - 撰寫交通車登記流程的整合測試
  - _需求: 4.1, 4.2, 4.3, 4.4, 4.5_

- [x] 12. 建立報名處理 API 服務





  - 實作報名資料接收和驗證端點
  - 建立報名資料格式化和 Pretix 訂單建立邏輯
  - 實作報名成功後的確認訊息和訂單號生成
  - 建立報名失敗的錯誤處理和重試機制
  - 實作報名資料的資料庫儲存和狀態管理
  - 撰寫報名處理流程的完整測試
  - _需求: 5.1, 5.2, 5.3, 5.4_

- [x] 13. 實作 LINE 訊息通知服務





  - 建立 LINE Messaging API 整合
  - 實作報名成功通知訊息發送
  - 建立活動提醒和重要資訊推送功能
  - 實作好友狀態檢查和加好友引導
  - 建立訊息模板和個人化內容系統
  - 撰寫 LINE 訊息服務的模擬測試
  - _需求: 6.3, 6.4_

- [x] 14. 建立報名狀態查詢功能





  - 實作報名記錄查詢 API 端點
  - 建立報名狀態顯示頁面
  - 實作報名資料修改功能（在允許時間內）
  - 建立活動提醒和重要資訊顯示
  - 實作報名取消和退款處理邏輯
  - 撰寫報名查詢功能的功能測試
  - _需求: 8.1, 8.2, 8.3, 8.4_

- [x] 15. 實作完整報名流程整合





  - 建立報名流程的狀態管理和頁面導航
  - 整合身份選擇、活動選擇、資料填寫、交通登記流程
  - 實作報名進度指示器和步驟導航
  - 建立報名確認頁面和成功頁面
  - 實作報名流程的資料持久化和恢復
  - 撰寫完整報名流程的 E2E 測試
  - _需求: 1.1, 2.3, 3.5, 4.5, 5.2_

- [x] 16. 建立錯誤處理和使用者體驗優化





  - 實作全域錯誤邊界和錯誤頁面
  - 建立網路連線錯誤的重試機制
  - 實作載入狀態和骨架屏顯示
  - 建立友善的錯誤訊息和解決建議
  - 實作離線狀態檢測和提示
  - 撰寫錯誤處理機制的測試案例
  - _需求: 7.4, 7.5_

- [x] 17. 實作資料驗證和安全性功能





  - 建立前端輸入清理和 XSS 防護
  - 實作後端資料驗證中介軟體
  - 建立 API 速率限制和 DDOS 防護
  - 實作敏感資料加密和安全儲存
  - 建立存取日誌和安全監控
  - 撰寫安全性功能的滲透測試
  - _需求: 5.3, 6.1_

- [x] 18. 建立測試資料和開發環境
  - 建立測試用的 Pretix 活動和項目配置
  - 實作測試資料生成和清理腳本
  - 建立開發環境的 Mock API 服務
  - 實作自動化測試資料庫重置功能
  - 建立測試環境的 LINE 和 Pretix 模擬器
  - 撰寫測試環境設定的文件和腳本
  - _需求: 所有需求的測試支援_

- [x] 19. 實作效能優化和快取機制





  - 建立 API 回應快取和資料預載入
  - 實作圖片和靜態資源優化
  - 建立前端程式碼分割和懶載入
  - 實作資料庫查詢優化和索引
  - 建立 CDN 配置和靜態資源部署
  - 撰寫效能監控和分析工具
  - _需求: 7.1, 7.4_

- [x] 20. 建立部署和監控系統





  - 設定 Netlify 前端自動部署流程
  - 建立後端 Heroku/Railway 部署配置
  - 實作環境變數管理和安全配置
  - 建立健康檢查和服務監控端點
  - 實作錯誤追蹤和效能監控整合
  - 建立部署文件和維運手冊
  - _需求: 系統維運和監控_

- [x] 21. 實作報名狀態查詢頁面












  - 建立報名查詢頁面（/registrations）
  - 實作報名記錄顯示和狀態更新
  - 建立報名資料修改功能（在允許時間內）
  - 整合現有的身份管理和 API 服務
  - 撰寫報名查詢功能的測試
  - _需求: 8.1, 8.2, 8.3, 8.4_

- [x] 22. 建立活動資訊頁面





  - 實作活動資訊頁面（/info）
  - 顯示最新活動訊息和注意事項
  - 建立常見問題和聯絡資訊
  - 實作響應式設計和無障礙功能
  - _需求: 7.1, 7.2, 7.3_

- [x] 23. 完善 LIFF 整合和錯誤處理





  - 優化 LIFF 初始化和使用者驗證流程
  - 實作網路連線錯誤的重試機制
  - 建立友善的錯誤訊息和解決建議
  - 實作離線狀態檢測和提示
  - 加強 LINE 權限檢查和請求功能
  - _需求: 6.1, 6.2, 6.3, 6.4, 7.4, 7.5_

- [x] 24. 建立報名處理 API 端點










  - 實作報名資料接收和驗證 API 端點
  - 建立報名資料格式化和處理邏輯
  - 實作報名成功後的確認訊息和 ID 生成
  - 建立報名失敗的錯誤處理和重試機制
  - 實作報名資料的資料庫儲存和狀態管理
  - 撰寫報名處理流程的完整測試
  - _需求: 5.1, 5.2, 5.3, 5.4_

- [x] 25. 實作報名修改和取消 API





  - 建立報名資料修改 API 端點
  - 實作報名取消和狀態更新功能
  - 建立報名修改權限和時間限制檢查
  - 實作報名歷史記錄和變更追蹤
  - 撰寫報名修改功能的測試
  - _需求: 8.2, 8.3_